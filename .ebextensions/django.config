option_settings:
  aws:elasticbeanstalk:container:python:
    WSGIPath: Recarnation-Techtitans/cardealer/wsgi.py
    NumProcesses: 1  # Reduced for t3.micro stability
    NumThreads: 4    # Optimal for low-memory instances
  aws:elasticbeanstalk:application:environment:
    DJANGO_SETTINGS_MODULE: cardealer.settings
    PYTHONPATH: /var/app/current:$PYTHONPATH

files:
  "/etc/systemd/system/gunicorn.service":
    mode: "000644"
    owner: root
    group: root
    content: |
      [Unit]
      Description=Gunicorn server for Django
      After=network.target
      
      [Service]
      User=ec2-user
      Group=ec2-user
      WorkingDirectory=/var/app/current
      Environment="PYTHONPATH=/var/app/current"
      Environment="DJANGO_SETTINGS_MODULE=cardealer.settings"
      ExecStart=/usr/bin/gunicorn \
          --bind 0.0.0.0:8000 \
          --pythonpath /var/app/current \
          cardealer.wsgi:application
      Restart=always
      RestartSec=3
      
      [Install]
      WantedBy=multi-user.target
