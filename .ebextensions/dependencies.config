packages:
  yum:
    python3: []
    python3-pip: []
    python3-devel: []
    gcc: []
    openssl-devel: []
    libffi-devel: []

container_commands:
  01_install_deps:
    command: |
      #!/bin/bash
      echo "[INFO] Checking for pip3"
      command -v pip3 || { echo "[ERROR] pip3 not found"; exit 1; }

      echo "[INFO] Skipping pip upgrade to avoid RPM conflict"

      echo "[INFO] Searching for requirements.txt"
      if [ -f /var/app/current/requirements.txt ]; then
          echo "[INFO] Found requirements.txt in root, installing..."
          pip3 install -r /var/app/current/requirements.txt
      elif [ -f /var/app/current/Recarnation-TechTitans/requirements.txt ]; then
          echo "[INFO] Found requirements.txt in nested folder, installing..."
          pip3 install -r /var/app/current/Recarnation-TechTitans/requirements.txt
      else
          echo "[ERROR] requirements.txt not found in expected paths"
          find /var/app/current -name "requirements.txt"
          exit 1
      fi
    leader_only: true
