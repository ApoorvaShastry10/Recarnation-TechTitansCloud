# .ebextensions/debug_deploy.config
files:
  "/opt/elasticbeanstalk/hooks/appdeploy/pre/09_debug_staging.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      echo "=== STAGING CONTENTS ==="
      ls -la /var/app/staging
      echo "=== CURRENT CONTENTS ==="
      ls -la /var/app/current
      echo "=== DISK SPACE ==="
      df -h

commands:
  01_ensure_permissions:
    command: "chown -R webapp:webapp /var/app/staging"
    ignoreErrors: false

container_commands:
  99_log_final_state:
    command: "ls -la /var/app/staging > /tmp/staging_final.log"
    leader_only: false
